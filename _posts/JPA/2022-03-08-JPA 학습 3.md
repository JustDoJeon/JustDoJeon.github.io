---
layout : single
title:  "[JPA] JPQLê³¼ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ 1"
categories: JPA
tags:
  - [JPA]

toc: true
toc_sticky: true
 
date: '2022-03-08 00:00:00 +0900'

---

# JPQL (Java Persistence Query Language)

- JPQLì€ JPAì˜ ì¼ë¶€ë¡œ ì •ì˜ëœ í”Œë«í¼ìœ¼ë¡œ ë…ë¦½ì ì¸ ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì–¸ì–´ë‹¤.
- JPQLì€ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ì˜ ì—”í‹°í‹°ì— ëŒ€í•œ ì¿¼ë¦¬ë¥¼ ë§Œë“œëŠ”ë° ì‚¬ìš©ëœë‹¤.
- SQLì— í¬ê²Œ ì˜í–¥ì„ ë°›ì•„ SQLë¬¸ê³¼ ë¹„ìŠ·í•˜ì§€ë§Œ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì— ì§ì ‘ì—°ê²°ë˜ëŠ”ê²ƒì´ ì•„ë‹ˆë¼ JPAì—”í‹°í‹°ì— ëŒ€í•´ ë™ì‘í•œë‹¤.
- ê·¸ëŸ¬ë¯€ë¡œ, JPQLì˜ ì¿¼ë¦¬ì—ëŠ” í…Œì´ë¸”ì´ ì•„ë‹Œ ì—”í‹°í‹°ì—ì„œ í‘œí˜„í•˜ê³  ìˆëŠ” ì¹¼ëŸ¼ì˜ ì´ë¦„ì„ ì¨ì¤˜ì•¼í•œë‹¤.

> EX) TypedQuery<Member> query = em.createQuery("select m from Member m", Memeber.class); 
> List<Member> memberList = query.getResultList();

<BR>

- JPAì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ 2ê°€ì§€ 
- 1. ê°ì²´ì™€ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ ë§¤í•‘í•˜ê¸°
- 2. ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ 

<br>

# ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ 

<br>

<img width="674" alt="ì˜ì†ì„±2" src="https://user-images.githubusercontent.com/52389219/157172728-241b65e5-13f4-43d7-9bd2-d9d16207da96.png">

#### ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ì™€ ì—”í‹°í‹° ë§¤ë‹ˆì € 

- ê³ ê°ì˜ ìš”ì²­ì´ ì˜¬ë•Œë§ˆë‹¤ ì—”í‹°í‹° ë§¤ë‹ˆì €ë¥¼ ìƒì„±í•˜ê³  ë‚´ë¶€ì ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë„¥ì…˜ì„ ì‚¬ìš©í•´ì„œ ë””ë¹„ë¥¼ ì‚¬ìš©í•œë‹¤.

- ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ : ì—”í‹°í‹°ë¥¼ ì˜êµ¬ ì €ì¥í•˜ëŠ” í™˜ê²½ì´ë¼ëŠ” ëœ» , EntityManager ì•ˆì— ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ ì¡´ì¬í•œë‹¤.

- EntityManager.persist(entity); - > ë””ë¹„ì— ì €ì¥í•˜ëŠ”ê²ƒì´ ì•„ë‹ˆë¼ ì—”í‹°í‹°ë¥¼ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì €ì¥í•˜ëŠ”ê²ƒ  


<img width="473" alt="ì˜ì†ì„±1" src="https://user-images.githubusercontent.com/52389219/157172639-9c5bdaf0-8b35-4fe5-a05b-d90729caf51c.png">

<br>

> EntityManagerFacory 

- ë°ì´í„°ë² ì´ìŠ¤ë¥¼ í•˜ë‚˜ë§Œ ì‚¬ìš©í•˜ëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ì€ ì¼ë°˜ì ìœ¼ë¡œ EntityManagerFactoryë¥¼ í•˜ë‚˜ë§Œ ìƒì„±í•œë‹¤.
- ë§Œë“œëŠ” ë¹„ìš©ì´ ìƒë‹¹íˆ í¬ê³  í•œ ê°œë§Œ ë§Œë“¤ì–´ì„œ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ì—ì„œ ê³µìœ í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆë‹¤.
- ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— ì ‘ê·¼í•´ë„ ì•ˆì „í•˜ê³ , ì„œë¡œ ë‹¤ë¥¸ ìŠ¤ë ˆë“œ ê°„ì˜ ê³µìœ ê°€ ê°€ëŠ¥í•˜ë‹¤.

<br>

> EntityManager ìƒì„±

- EntityManger em = emf.createEntityManager(); //ì—”í‹°í‹° ë§¤ë‹ˆì € ìƒì„±
- ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— ì ‘ê·¼í•˜ë©´ ë™ì‹œì„± ë¬¸ì œê°€ ë°œìƒí•œë‹¤.
- ìŠ¤ë ˆë“œê°„ì˜ ì ˆëŒ€ ê³µìœ ë¥¼ í•˜ë©´ ì•ˆëœë‹¤.
- ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì´ í•„ìš”í•œ ì‹œì ê¹Œì§€ ì»¤ë„¥ì…˜ì„ ì–»ì§€ ì•ŠëŠ”ë‹¤. 

#### ì—”í‹°í‹°ì˜ ìƒëª…ì£¼ê¸°

<BR>

![ì—”í‹°í‹°](https://user-images.githubusercontent.com/52389219/157174914-f1cf1f4b-444c-4e18-9807-e457ea6d59f1.PNG)


<br>

#### ë¹„ì˜ì† ìƒíƒœ

- ë©¤ë²„ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì˜ì† ì»¨í…ìŠ¤íŠ¸(entityManager)ì— ë„£ì§€ ì•Šì€ ìƒíƒœ

```java
Member member = new Member();
member.setId("ë©¤ë²„1");
member.setUserName("íšŒì›1");
```

<br>

####  ì˜ì† ìƒíƒœ

- ë§´ë²„ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì˜ì† ì»¨í…ìŠ¤íŠ¸ì— ë„£ì€ ìƒíƒœ

```java
//ê°ì²´ë¥¼ ìƒì„±í•œ ìƒíƒœ(ë¹„ì˜ì†)
Member member = new Member();
member.setId("ë©¤ë²„1");
member.setUserName("íšŒì›1");

EntityManager em = emf.createEntityManager();
em.getTransaction().begin();

//ê°ì²´ë¥¼ ì €ì¥í•œ ìƒíƒœ(ì˜ì†)
em.persist(member);
```

<br>

#### ì¤€ì˜ì†ê³¼ ì‚­ì œ ìƒíƒœ

```java
    //ë¹„ì˜ì†
     Member member = new Member();
    member.setId(100L);
    member.setName("HelloJPA");

    //ì˜ì†
    System.out.println("=====BEFORE=====");
    em.persist(member);
    em.detach(member); // ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ë‹¤ì‹œ ì§€ì›€ 
    em.remove(member); // ì‹¤ì œ ë””ë¹„ì—ì„œ ì‚­ì œë¥¼ ì‹¤í–‰í•¨
    System.out.println("=====AFTER=====");
    tx.commit();
```

<br>

> ë‹¤ìŒ ë‚´ìš© : ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ì´ì  


<br>

ğŸ˜„ ì°¸ê³  : ì¸í”„ëŸ° ê¹€ì˜í•œë‹˜ì˜ JPA ê¸°ë³¸ ê°•ì˜ ë° êµì¬ , [ë¸”ë¡œê·¸](https://ultrakain.gitbooks.io/jpa/content/chapter3/chapter3.1.html) , [ë¸”ë¡œê·¸](https://donnaknew.tistory.com/3)

ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° 
ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„
<br>

**ê°œì¸ë©”ëª¨** 
